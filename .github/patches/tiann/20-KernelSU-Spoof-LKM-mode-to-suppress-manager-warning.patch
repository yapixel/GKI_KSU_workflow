From 8a1e1c1a4f4ba3e0c9604bfda27ef11986202758 Mon Sep 17 00:00:00 2001
From: deepongi <infectedmushi@gmail.com>
Date: Sat, 6 Dec 2025 18:48:39 +0000
Subject: [PATCH] fix LKM spoof patch for KSU tiann

---
 kernel/supercalls.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/kernel/supercalls.c b/kernel/supercalls.c
index 7e677294..cc876ff6 100644
--- a/kernel/supercalls.c
+++ b/kernel/supercalls.c
@@ -77,7 +77,7 @@ static int do_get_info(void __user *arg)
 {
     struct ksu_get_info_cmd cmd = {.version = KERNEL_SU_VERSION, .flags = 0};
 
-#ifdef MODULE
+#if defined(MODULE) || defined(CONFIG_KSU)
     cmd.flags |= 0x1;
 #endif
 
-- 
2.52.0

